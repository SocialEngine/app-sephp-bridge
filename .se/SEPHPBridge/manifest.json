{
    "author": "",
    "componentReplacements": {},
    "css": "",
    "dependencies": {},
    "description": "",
    "guid": "b365c544-f167-4ad8-b22d-4c0070e13505",
    "hidden": false,
    "id": "@SE/SEPHPBridge",
    "installUpgradeRules": {},
    "license": "",
    "main": "Bootstrap.js",
    "mainAcp": "ACPBootstrap.js",
    "moduleCode": "const app = require('app');\n\n/*\n * EDIT[12]\n */\n\nconst validMigrations = {\n    users: {\n        id: 'users',\n        name: 'Users',\n    },\n    connections: {\n        id: 'connections',\n        name: 'Connections',\n        dependency: ['users']\n    },\n    status: {\n        id: 'status',\n        name: 'Status Updates',\n        dependency: ['users', 'connections']\n    },\n    'blogs-categories': {\n        id: 'blogs-categories',\n        name: 'Blog Categories',\n        requires: ['@SE/Topic']\n    },\n    blogs: {\n        id: 'blogs',\n        name: 'Blogs',\n        dependency: ['users', 'connections', 'blog-categories'],\n        requires: ['@SE/Topic']\n    },\n    'albums-categories': {\n        id: 'albums-categories',\n        name: 'Album Categories',\n        requires: ['@SE/Media']\n    },\n    albums: {\n        id: 'albums',\n        name: 'Albums',\n        dependency: ['users', 'connections', 'albums-categories'],\n        requires: ['@SE/Topic']\n    },\n    'videos-categories': {\n        id: 'videos-categories',\n        name: 'Video Categories',\n        requires: ['@SE/Video']\n    },\n    videos: {\n        id: 'videos',\n        name: 'Videos',\n        dependency: ['users', 'connections', 'videos-categories'],\n        requires: ['@SE/Video']\n    }\n};\n\nmodule.exports = {\n    migration: {\n        all: () => {\n            return validMigrations;\n        },\n\n        getKey: async (type, key) => {\n            return app.data.get('sephp:migration:' + type + ':' + key);\n        },\n\n        set: async (type, key, value) => {\n            await app.data.set('sephp:migration:' + type + ':' + key, value);\n        },\n\n        del: async (type, key) => {\n            await app.data.del('sephp:migration:' + type + ':' + key);\n        },\n\n        get: async (type)  => {\n            const migration = validMigrations[type];\n            const keys = [\n                'started',\n                'socketId',\n                'completed',\n                'failed',\n                'total',\n                'page'\n            ];\n            for (const key of keys) {\n                migration[key] = await app.data.get('sephp:migration:' + type + ':' + key);\n            }\n            return migration;\n        }\n    },\n\n    request: async function (method, endpoint, query = {}) {\n        const url = await app.data.get('sephp:url');\n        const token = await app.data.get('sephp:token');\n        let search = '';\n        let iteration = 0;\n        let props = {};\n        for (const key of Object.keys(query)) {\n            iteration++;\n            if (iteration !== 1) {\n                search += '&';\n            }\n            search += key + '=' + encodeURIComponent(query[key]);\n        }\n        if (search && method === 'GET') {\n            endpoint = endpoint + '?' + search;\n        }\n        if (method !== 'GET') {\n            props.body = JSON.stringify(query);\n        }\n        const request = await app.fetch(url + endpoint, {\n            method: method,\n            ...props,\n            headers: {\n                'SE-Unite-Token': token,\n                'Content-Type': 'application/json'\n            }\n        });\n        return request.json();\n    },\n\n    async getUrl () {\n        return app.data.get('sephp:url');\n    },\n\n    async getUserFromLegacyId (id) {\n        let legacyUser = await app.data.get(\n            'sephp:migration:users:reverse:' + id\n        );\n        return app.api.users.read(legacyUser);\n    },\n\n    async getUser (id) {\n        let legacyUser = await app.data.get(\n            'sephp:migration:users:data:' + id\n        );\n        if (legacyUser) {\n            legacyUser = JSON.parse(legacyUser);\n        }\n        return legacyUser;\n    },\n\n    async updateUser (id, data) {\n        let current = await this.getUser(id);\n        if (!current) {\n            current = {};\n        }\n        await app.data.set(\n            'sephp:migration:users:data:' + id\n            , JSON.stringify({\n                ...current,\n                ...data\n            }));\n\n        return this.getUser(id);\n    }\n};\n",
    "price": "0",
    "priceRecurring": "0",
    "repository": "",
    "storeCertified": "1",
    "storeStatus": "active",
    "title": "SEPHP Bridge",
    "type": "app",
    "version": "1.0.6"
}
